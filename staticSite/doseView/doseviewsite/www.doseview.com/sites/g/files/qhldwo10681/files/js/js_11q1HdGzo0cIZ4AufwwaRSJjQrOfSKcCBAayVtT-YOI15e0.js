/* @license GPL-2.0-or-later https://www.drupal.org/licensing/faq */
var benchmark={selectedDrug:0,useDrupalData:!1,initialized:!1,init:function(){$.get("/benchmark_data",function(a){"1"==a.drupal_data.use_dv_module_data?(benchmark.useDrupalData=!0,values.defaults.values=a.drupal_data.values):values.defaults.values=values.defaults.values,benchmark.initialized=!0,benchmark.finish_init();}).done(function(a){}).fail(function(){values.defaults.values=values.defaults.values,benchmark.initialized=!0,benchmark.finish_init();}).always(function(){});},finish_init:function(){analyticsTracker.bindBenchmark(),calculate.isBeingStupid=!1,ui.init(),benchmark.selectedDrug=0,benchmark.buildChartNav(),benchmark.charts.init(),benchmark.scroll.bind(),$(".grey-divide .blue-button").click(function(){app.loadPage(2);}),$(".nicescroll-rails").remove();},scroll:{bind:function(){$(document).bind("scroll",benchmark.scroll.mouseScroll),$(document).bind("touchmove",benchmark.scroll.mouseScroll);},mouseScroll:function(a){var e=document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop,d=$(".grey-divide");if(!d.length)return;var l=d.offset().top-400;e>550&&e<l?$(".button-list").addClass("fixed-button-list"):$(".button-list").removeClass("fixed-button-list");}},buildChartNav:function(){for(i=0;i<values.defaults.values.length;i++){var a="";0==i&&(a=" active"),calculate.isBeingStupid?-1==values.defaults.values[i].htmlLabel.indexOf("ARISTADA")&&-1==values.defaults.values[i].htmlLabel.indexOf("TRINZA")&&$(".chart-nav").append('<li class="button grey-button'+a+'" rel-drug="'+i+'">'+values.defaults.values[i].htmlLabel+"</li>"):$(".chart-nav").append('<li class="button grey-button'+a+'" rel-drug="'+i+'">'+calculate.charts.removeOrreplaceSups(values.defaults.values[i].htmlLabel)+"</li>");}$(".chart-nav li").click(function(){$(".chart-nav li").removeClass("active"),$(this).addClass("active"),benchmark.selectedDrug=$(this).attr("rel-drug"),benchmark.charts.init();});},charts:{init:function(){calculate.init(!0),benchmark.charts.buildCharts();},buildCharts:function(){calculate.charts.buildDoseMix(benchmark.selectedDrug),calculate.charts.buildWad(),calculate.charts.buildWac();}}};;
var calculator={periods:['Monthly','Quarterly','Annually'],quarters:[{label:'Q1',months:[0,1,2]},{label:'Q2',months:[3,4,5]},{label:'Q3',months:[6,7,8]},{label:'Q4',months:[9,10,11]}],anuals:[{label:'2013',months:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']},{label:'2014',months:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']},{label:'2015',months:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']}],selectedPeriod:0,months:['January','February','March','April','May','June','July','August','September','October','November','December'],shortMonths:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],years:['2013','2014','2015','2016','2017','2018','2019'],startDate:null,endDate:null,pdfStartDate:null,pdfEndDate:null,selectedDates:[],selectedDrugs:[],selectedYears:[],displayDates:[],userValues:[],selectedDrug:0,hasScroll:false,scrollPaned:false,useDrupalData:false,init:function(){var jqxhrSources=$.get("/benchmark_data",function(data){if(data.drupal_data.use_dv_module_data=="1"){calculator.useDrupalData=true;values.defaults.values=data.drupal_data["values"];yearStart=Number(data.drupal_data.time_period.start);yearEnd=Number(data.drupal_data.time_period.end);calculator.years=[];for($i=0;$i<=(yearEnd-yearStart);$i++)calculator.years[$i]=yearStart+$i;console.log("AJAX call succeeded, calculator.js is using drupal provided data.");}else{values.defaults.values=values.defaults.values;console.log("AJAX call succeeded, calculator.js is using values.js data.");}calculator.finish_init();}).done(function(data){}).fail(function(){values.defaults.values=values.defaults.values;console.log("AJAX call failed, calculator.js is using values.js data");calculator.finish_init();}).always(function(){});},finish_init:function(){analyticsTracker.bindCalc();calculate.isBeingStupid=false;ui.init();if(userInput&&userInput.length>0){$('#calculator').html(userInput);calculator.domListeners();ui.elements();}else{calculator.buildProductSelectList();calculator.buildDropdowns();}$('.btn-calculate').click(function(){calculator.validate('inputs',calculator.calculate);});$('.btn-cancel').addClass('disabled');$('.btn-cancel').click(function(){if(!$(this).hasClass('disabled'))calculator.onCancel();});calculator.testScroll();$('.my-selected-periods').stickyTableHeaders('destroy');$('.my-selected-periods').stickyTableHeaders({scrollableArea:$('.the-table-container')});$('.btn-edit-data').click(function(){$('#results').hide();$('#calculator').show();calculator.testScroll();$('.the-table-container').getNiceScroll().show();$('.the-table-container').getNiceScroll().resize();$('body').scrollTop($('#yourTrxData').offset().top);$('.btn-cancel').removeClass('disabled');$('.my-selected-products-table tr td input').each(function(x){$(this).removeClass('error');});ui.elements();});},onCancel:function(){$('#calculator').html(userCalcs);calculator.domListeners();userInput=userCalcs;$('.btn-cancel').removeClass('disabled');$('.btn-cancel').click(function(){calculator.onCancel();});$('.btn-edit-data').click(function(){$('#results').hide();$('#calculator').show();$('body').scrollTop($('#yourTrxData').offset().top);$('.btn-cancel').removeClass('disabled');$('.my-selected-products-table tr td input').each(function(x){$(this).removeClass('error');});});$('.btn-calculate').click(function(){calculator.validate('inputs',calculator.calculate);});calculator.calculate();},scroll:{bind:function(){$(document).bind('scroll',calculator.scroll.mouseScroll);$(document).bind('touchmove',calculator.scroll.mouseScroll);},mouseScroll:function(event){var _st=(document.documentElement&&document.documentElement.scrollTop)||document.body.scrollTop;var _maxSt=$('#res-isi').offset().top-600;if(_st>60&&_st<_maxSt){$('.button-list').addClass('fixed-button-list');$('#results .subpage-container').css('margin-left','175px');}else $('.button-list').removeClass('fixed-button-list');}},buildProductSelectList:function(){$('.select-product-list').html('');for(i=0;i<values.defaults.values.length;i++)if(calculator.useDrupalData){if(values.defaults.values[i].includeOnCalc==1)if(i==1||i==3||i==4)$('.select-product-list').append('<li class="select-product grey selected" rel-drug="'+i+'">'+values.defaults.values[i].htmlLabel.replace("&dagger;","")+'*</li>');else $('.select-product-list').append('<li class="select-product grey selected" rel-drug="'+i+'">'+values.defaults.values[i].htmlLabel+'</li>');}else if(i==1||i==3||i==4)$('.select-product-list').append('<li class="select-product grey selected" rel-drug="'+i+'">'+values.defaults.values[i].htmlLabel.replace("&dagger;","")+'*</li>');else $('.select-product-list').append('<li class="select-product grey selected" rel-drug="'+i+'">'+values.defaults.values[i].htmlLabel+'</li>');$('.select-product').click(function(){$('.select-product').removeClass('error');$(this).toggleClass('selected');if($(this).attr('rel-drug')!=2&&!$("li[rel-drug='1']").hasClass('selected'))$(".select-product-list li[rel-drug='2']").removeClass('selected');if($(this).attr('rel-drug')==2&&$(this).hasClass('selected'))$(".select-product-list li[rel-drug='1']").addClass('selected');calculator.validate('select-product',calculator.buildTable);$('.tableFloatingHeaderOriginal .selected-dates-header').each(function(i){var pos=$(this).position().left;var x=$('.my-selected-products-table').offset().left;x=x+250;if(pos<x)$(this).addClass('scrolled');else $(this).removeClass('scrolled');});});calculator.buildTable();},validate:function(_test,_callback){var _passed=false;if(_test=='select-product')if($('.select-product.selected').length!=0)_passed=true;else{$('.select-product').addClass('error');ui.showError('Please select at least one product.');}else{if(_test=='inputs')$('.my-selected-periods tr').each(function(i){var _rowPass=false;$(this).find('td').each(function(j){$(this).find('input').each(function(){if($(this).val().length!=0)_rowPass=true;$(this).on('change',function(){$('.my-selected-products li').each(function(x){if(x==i){$(this).removeClass('error');$('.error-alert').remove();}});$('.my-selected-products-table tr td input').each(function(x){$(this).removeClass('error');if(x==i){$(this).removeClass('error');$('.error-alert').remove();}});});});});if(!_rowPass){$('.my-selected-products li').each(function(x){if(x==i){$(this).addClass('error');ui.showError('Please enter at least one TRx value per product selected.');_passed=false;}});$('.my-selected-products-table tr td input').each(function(x){$(this).removeClass('error');if(x==i){$(this).addClass('error');ui.showError('Please enter at least one TRx value per product selected.');_passed=false;}});var _btns=[];$('button').each(function(){if($(this).css('display')!='none')_btns.push($(this).html());});if(_btns.join(',').indexOf('Select')!=-1){_passed=false;$('.my-selected-products-table tr td input').removeClass('error');ui.showError('Please select a start and end date.');}}else{_passed=true;var _btns=[];$('button').each(function(){if($(this).css('display')!='none')_btns.push($(this).html());});if(_btns.join(',').indexOf('Select')!=-1){_passed=false;$('.my-selected-products-table tr td input').removeClass('error');ui.showError('Please select a start and end date.');}}});}if(_passed){$('.error-alert').remove();_callback();}},buildDropdowns:function(){$('.periods-dropdown ul').html('');$('.from-dropdown1 ul').html('');$('.to-dropdown1 ul').html('');$('.to-dropdown2 ul').html('');for(var i=0;i<calculator.periods.length;i++)$('.periods-dropdown ul').append('<li rel-period="'+i+'"><a href="#">'+calculator.periods[i]+'</a></li>');for(var i=0;i<calculator.months.length;i++){$('.from-dropdown1 ul').append('<li rel-month="'+i+'"><a href="#">'+calculator.months[i]+'</a></li>');$('.to-dropdown1 ul').append('<li rel-month="'+i+'"><a href="#">'+calculator.months[i]+'</a></li>');}for(var i=0;i<calculator.years.length;i++){$('.from-dropdown2 ul').append('<li rel-year="'+i+'"><a href="#">'+calculator.years[i]+'</a></li>');$('.to-dropdown2 ul').append('<li rel-year="'+i+'"><a href="#">'+calculator.years[i]+'</a></li>');}$('.periods-dropdown li').bind('click',function(e){var _period=$(this).attr('rel-period');$('#periodsDropdown').attr('rel-period',_period);$('#periodsDropdown').html($(this).find('a').text()+' <span class="caret"></span>');calculator.selectedPeriod=Number(_period);if(_period==0){$('#fromDropdown1').show();$('#toDropdown1').show();$('.from-dropdown1 ul').html('');$('.to-dropdown1 ul').html('');$('#fromDropdown1').attr('rel-month','0');$('#fromDropdown1').html(calculator.months[0]+' <span class="caret"></span>');$('#toDropdown1').attr('rel-month','0');$('#toDropdown1').html(calculator.months[0]+' <span class="caret"></span>');for(var i=0;i<calculator.months.length;i++){$('.from-dropdown1 ul').append('<li rel-month="'+i+'"><a href="#">'+calculator.months[i]+'</a></li>');$('.to-dropdown1 ul').append('<li rel-month="'+i+'"><a href="#">'+calculator.months[i]+'</a></li>');}}else if(_period==1){$('#fromDropdown1').show();$('#toDropdown1').show();$('.from-dropdown1 ul').html('');$('.to-dropdown1 ul').html('');$('#fromDropdown1').attr('rel-month','0');$('#fromDropdown1').attr('rel-q','0');$('#fromDropdown1').html(calculator.quarters[0].label+' <span class="caret"></span>');$('#toDropdown1').attr('rel-month','0');$('#toDropdown1').attr('rel-q','0');$('#toDropdown1').html(calculator.quarters[0].label+' <span class="caret"></span>');for(var i=0;i<calculator.quarters.length;i++){$('.from-dropdown1 ul').append('<li rel-month="0" rel-q="'+i+'"><a href="#">'+calculator.quarters[i].label+'</a></li>');$('.to-dropdown1 ul').append('<li rel-month="0" rel-q="'+i+'"><a href="#">'+calculator.quarters[i].label+'</a></li>');}}else{$('#fromDropdown1').hide();$('#toDropdown1').hide();}calculator.dropdownListeners();calculator.buildTable();e.preventDefault();});calculator.dropdownListeners();},dropdownListeners:function(){$('.from-dropdown1 li').bind('click',function(e){$('#fromDropdown1').attr('rel-month',$(this).attr('rel-month'));$('#fromDropdown1').attr('rel-q',$(this).attr('rel-q'));$('#fromDropdown1').html($(this).find('a').text()+' <span class="caret"></span>');calculator.validateChronologicalOrder();calculator.buildTable();e.preventDefault();});$('.to-dropdown1 li').bind('click',function(e){$('#toDropdown1').attr('rel-month',$(this).attr('rel-month'));$('#toDropdown1').attr('rel-q',$(this).attr('rel-q'));$('#toDropdown1').html($(this).find('a').text()+' <span class="caret"></span>');calculator.validateChronologicalOrder();calculator.buildTable();e.preventDefault();});$('.from-dropdown2 li').bind('click',function(e){$('#fromDropdown2').attr('rel-year',$(this).attr('rel-year'));$('#fromDropdown2').html($(this).find('a').text()+' <span class="caret"></span>');calculator.validateChronologicalOrder();calculator.buildTable();e.preventDefault();});$('.to-dropdown2 li').bind('click',function(e){$('#toDropdown2').attr('rel-year',$(this).attr('rel-year'));$('#toDropdown2').html($(this).find('a').text()+' <span class="caret"></span>');calculator.validateChronologicalOrder();calculator.buildTable();e.preventDefault();});$('#calculator .dropdown-menu li').click(function(){var test=$('.from-dropdown1 button').css('display');if($('.from-dropdown1 button').css('display')=='none'){if($('.from-dropdown2').text().indexOf("Select")==-1)$('.to-dropdown2 button').removeAttr("disabled");}else{if($('.from-dropdown1').text().indexOf("Select")==-1&&$('.from-dropdown2').text().indexOf("Select")==-1){$('.to-dropdown1 button').removeAttr("disabled");$('.to-dropdown2 button').removeAttr("disabled");}}});},validateChronologicalOrder:function(){if($('.to-dropdown1').text().indexOf("Select")==-1&&$('.to-dropdown2').text().indexOf("Select")==-1){var fromYear=parseInt($('#fromDropdown2').attr('rel-year'));var toYear=parseInt($('#toDropdown2').attr('rel-year'));var fromMonth=parseInt($('#fromDropdown1').attr('rel-month'));var toMonth=parseInt($('#toDropdown1').attr('rel-month'));var fromQuarter=parseInt($('#fromDropdown1').attr('rel-q'));var toQuarter=parseInt($('#toDropdown1').attr('rel-q'));if(fromYear>>toYear)$('#calculator .beauty p.error').show();else if((fromYear==toYear)&&(fromMonth>toMonth))$('#calculator .beauty p.error').show();else if((fromYear==toYear)&&(fromQuarter>toQuarter))$('#calculator .beauty p.error').show();else $('#calculator .beauty p.error').hide();}},domListeners:function(){$('.select-product').click(function(){$('.select-product').removeClass('error');$(this).toggleClass('selected');calculator.validate('select-product',calculator.buildTable);});$('.periods-dropdown li').bind('click',function(e){var _period=$(this).attr('rel-period');$('#periodsDropdown').attr('rel-period',_period);calculator.selectedPeriod=Number(_period);if(_period==0){$('#fromDropdown1').show();$('#toDropdown1').show();$('.from-dropdown1 ul').html('');$('.to-dropdown1 ul').html('');$('#fromDropdown1').attr('rel-month','0');$('#fromDropdown1').html(calculator.months[0]+' <span class="caret"></span>');$('#toDropdown1').attr('rel-month','0');$('#toDropdown1').html(calculator.months[0]+' <span class="caret"></span>');for(var i=0;i<calculator.months.length;i++){$('.from-dropdown1 ul').append('<li rel-month="'+i+'"><a href="#">'+calculator.months[i]+'</a></li>');$('.to-dropdown1 ul').append('<li rel-month="'+i+'"><a href="#">'+calculator.months[i]+'</a></li>');}}else if(_period==1){$('#fromDropdown1').show();$('#toDropdown1').show();$('.from-dropdown1 ul').html('');$('.to-dropdown1 ul').html('');$('#fromDropdown1').attr('rel-month','0');$('#fromDropdown1').attr('rel-q','0');$('#fromDropdown1').html(calculator.quarters[0].label+' <span class="caret"></span>');$('#toDropdown1').attr('rel-month','0');$('#toDropdown1').attr('rel-q','0');$('#toDropdown1').html(calculator.quarters[0].label+' <span class="caret"></span>');for(var i=0;i<calculator.quarters.length;i++){$('.from-dropdown1 ul').append('<li rel-month="0" rel-q="'+i+'"><a href="#">'+calculator.quarters[i].label+'</a></li>');$('.to-dropdown1 ul').append('<li rel-month="0" rel-q="'+i+'"><a href="#">'+calculator.quarters[i].label+'</a></li>');}}else{$('#fromDropdown1').hide();$('#toDropdown1').hide();}calculator.dropdownListeners();calculator.buildTable();e.preventDefault();});calculator.dropdownListeners();},buildTable:function(){var _selectedDrugs='<tr class="table-header"><td>&nbsp;</td></tr>';var _hasAristada=false;$('li.selected').each(function(x){var _drug=$(this).attr('rel-drug');for(var i=0;i<values.defaults.values[_drug].variants.length;i++){_selectedDrugs+='<tr class="small grey" rel-user-drug="'+x+'" rel-drug="'+_drug+'"><td><input type="text" readonly="true" value="'+values.defaults.values[_drug].variants[i].label.replace('®','').replace('®','').replace('<sup>&reg;</sup>','').replace('<sup>&reg;</sup>','').replace('<sup>&trade;</sup>','').replace('™','')+'"></td></tr>';calculator.selectedDrugs.push(_drug);if(values.defaults.values[_drug].variants[i].label.toLowerCase().indexOf('aristada')!=-1)_hasAristada=true;}});if(_hasAristada)$('.aristada-only').show();else $('.aristada-only').hide();var _startMonth=Number($('#fromDropdown1').attr('rel-month'));var _startQ=Number($('#fromDropdown1').attr('rel-q'));var _startYear=Number($('#fromDropdown2').attr('rel-year'));var _endMonth=Number($('#toDropdown1').attr('rel-month'))+1;var _endQ=Number($('#toDropdown1').attr('rel-q'));var _endYear=Number($('#toDropdown2').attr('rel-year'));if(calculator.selectedPeriod==1){_startMonth=calculator.quarters[_startQ].months[0];_endMonth=calculator.quarters[_endQ].months[2]+1;}else{if(calculator.selectedPeriod==2){_startMonth=0;_endMonth=12;}}var s=new Date(calculator.years[_startYear],_startMonth);var e=new Date(calculator.years[_endYear],_endMonth);var startDate;var endDate;if(calculator.selectedPeriod==1){startDate='Q'+(parseInt($('#fromDropdown1').attr('rel-q'))+1)+' '+$('#fromDropdown2').text().trim();endDate='Q'+(parseInt($('#toDropdown1').attr('rel-q'))+1)+' '+$('#toDropdown2').text().trim();}else if(calculator.selectedPeriod==2){startDate=$('#fromDropdown2').text().trim();endDate=$('#toDropdown2').text().trim();}else{startDate=calculator.months[s.getMonth()]+' '+$('#fromDropdown2').text().trim();endDate=calculator.months[_endMonth-1]+' '+$('#toDropdown2').text().trim();}calculator.startDate=startDate;calculator.endDate=endDate;calculator.pdfStartDate=startDate;calculator.pdfEndDate=endDate;$('.start-date').html(startDate);$('.end-date').html(endDate);calculator.selectedDates=[];calculator.selectedYears=[];while(s<e){var _m=calculator.shortMonths[s.getMonth()];var _y=s.getFullYear();calculator.selectedDates.push(_m+' '+_y);s=new Date(s.setMonth(s.getMonth()+1));}if(calculator.selectedPeriod==0)calculator.displayDates=calculator.selectedDates;else if(calculator.selectedPeriod==1){calculator.displayDates=[];for(var i=0;i<calculator.selectedDates.length;i=i+3){var _q='Q';if(calculator.selectedDates[i].indexOf('Jan')!=-1||calculator.selectedDates[i].indexOf('Feb')!=-1||calculator.selectedDates[i].indexOf('Mar')!=-1)_q+='1';else if(calculator.selectedDates[i].indexOf('Apr')!=-1||calculator.selectedDates[i].indexOf('May')!=-1||calculator.selectedDates[i].indexOf('Jun')!=-1)_q+='2';else if(calculator.selectedDates[i].indexOf('Jul')!=-1||calculator.selectedDates[i].indexOf('Aug')!=-1||calculator.selectedDates[i].indexOf('Sep')!=-1)_q+='3';else{if(calculator.selectedDates[i].indexOf('Oct')!=-1||calculator.selectedDates[i].indexOf('Nov')!=-1||calculator.selectedDates[i].indexOf('Dec')!=-1)_q+='4';}_q+=' ';_q+=calculator.selectedDates[i].slice(calculator.selectedDates[i].indexOf(' ')+1,calculator.selectedDates[i].length);calculator.displayDates.push(_q);}}else{if(calculator.selectedPeriod==2){calculator.displayDates=[];for(var i=0;i<calculator.selectedDates.length;i++){var _year=calculator.selectedDates[i].slice(calculator.selectedDates[i].indexOf(' ')+1,calculator.selectedDates[i].length);if(calculator.displayDates.join(',').indexOf(_year)==-1)calculator.displayDates.push(_year);}}}$('.my-selected-products').html(_selectedDrugs);$('.my-selected-products-table').html(_selectedDrugs);var _selectedPeriods='<thead><tr>';for(var i=0;i<calculator.displayDates.length;i++)_selectedPeriods+='<th class="selected-dates-header col-'+i+'">'+calculator.displayDates[i]+'</th>';_selectedPeriods+='</tr></thead><tbody>';var alphaCode='A';var numerCode=1;$('li.selected').each(function(x){var _drug=$(this).attr('rel-drug');for(var i=0;i<values.defaults.values[_drug].variants.length;i++){_selectedPeriods+='<tr>';for(var j=0;j<calculator.displayDates.length;j++)_selectedPeriods+='<td rel-user-drug="'+x+'" rel-drug="'+_drug+'" rel-variant="'+i+'"><input type="number" min="0" class="tableInput" id="cell:'+alphaCode+(numerCode++)+'"></td>';_selectedPeriods+='</tr>';alphaCode=String.fromCharCode(alphaCode.charCodeAt(0)+1);numerCode=1;}});_selectedPeriods+='</tbody>';$('.my-selected-periods').html(_selectedPeriods);$('.tableInput').on('paste',function(e){var pastedText=undefined;if(window.clipboardData&&window.clipboardData.getData)pastedText=window.clipboardData.getData('Text');else if(e.clipboardData&&e.clipboardData.getData)pastedText=e.clipboardData.getData('text/plain');else{if(e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.getData)pastedText=e.originalEvent.clipboardData.getData('text/plain');}if(pastedText.indexOf('\n')>=0||pastedText.indexOf('\t')>=0){var baseAlphaCode=this.id.substring(5,6);var baseNumerCode=Number(this.id.substring(6));$.each(pastedText.split('\n'),function(i,row){var alphaCode=String.fromCharCode(baseAlphaCode.charCodeAt(0)+i);$.each(row.split('\t'),function(i,cell){cell=cell.replace(/\D/g,'');var numerCode=baseNumerCode+i;$('#cell\\:'+alphaCode+numerCode).val(cell);});});e.preventDefault();}});$('input[type="number"]').change(function(){$(this).attr('value',$(this).val());userInput=$('#calculator').html();});var container=$('.scroll-pane');var api=container.data('jsp');if(api)api.destroy();if(calculator.displayDates.length>6){$('.scroll-pane').jScrollPane();if(api)$('.scroll-pane').css('padding-top','1px');calculator.scrollPaned=true;$('.jspHorizontalBar').show();var _h=($('.my-selected-periods tr').length*31)+25;$('.jspContainer').css('height',_h+'px');$('.jspPane').removeClass('less');}else{$('.jspHorizontalBar').hide();$('.jspPane').addClass('less');}var _h=($('.my-selected-periods tr').length*31)+25;if(_h>200){$('.jspVerticalBar .jspTrack').css('height',_h+'px');$('.jspVerticalBar').show();}else $('.jspVerticalBar').hide();try{$('.the-table-container').getNiceScroll().resize();if(!$('.my-selected-periods').hasClass('align-patch'))$('.my-selected-periods').addClass('align-patch');}catch(error){}if(calculator.displayDates.length*100<$('.scroll-pane').width())$('.my-selected-periods').removeClass('align-patch');$('.scroll-pane').bind('jsp-scroll-x',function(event,x,isAtLeft,isAtRight){var hidden=0;$('.tableFloatingHeaderOriginal .selected-dates-header').each(function(i){var pos=$(this).position().left;if(pos<x){$(this).addClass('scrolled');hidden++;}else $(this).removeClass('scrolled');});if(!$('.my-selected-periods').hasClass('align-patch'))$('.my-selected-periods').addClass('align-patch');calculator.forceScrollHide();}).bind('jsp-will-scroll-x',function(event,x,isAtLeft,isAtRight){calculator.forceScrollHide();});calculator.forceHorizontalScrollBarPosition();},testScroll:function(){if($('.the-table-container').offset()){var containerwidth=1300;var leftLeft=$('.the-table-container').offset().left;var leftRight=containerwidth+leftLeft+10;var top=$('.the-table-container').position().top-$(window).scrollTop()-100;var blockwidthRight=$(window).width()-leftRight;if($('.forcedScroll').length==0){var hiderRight='<div class="forcedScroll right below"></div>';$('body').append(hiderRight);}$('.forcedScroll.right').css('top',top+'px');$('.forcedScroll.right').css('left',leftRight+'px');$('.forcedScroll.right').css('width',blockwidthRight+'px').css('height','300px');if($('#results').css('display')=='none')$('.forcedScroll.right').show();calculator.forceHorizontalScrollBarPosition();}},forceScrollHide:function(){calculator.testScroll();},forceHorizontalScrollBarPosition:function(){if($('.jspContainer').offset()){var leftRight=$('.jspContainer').width()+$('.jspContainer').offset().left;var blockwidthRight=$(window).width()-leftRight;var tch=$('.the-table-container').height();var th=$('.my-selected-periods').height();if(th<tch)var _top=$('.the-table-container').offset().top+$('.my-selected-periods').height()-$(window).scrollTop();else _top=$('.the-table-container').offset().top+$('.the-table-container').height()-$(window).scrollTop();$('.jspHorizontalBar').css('position','fixed').css('top',_top+'px').css('left',(blockwidthRight+225)+'px');}},randomValues:function(){$('input[type="number"').each(function(){var _ran=Math.floor(Math.random()*(5000-25))+25;$(this).val(_ran);$(this).attr('value',_ran);});},clearData:function(){ui.overlay.remove();$('input[type="number"]').val('');$('input[type="number"]').attr('value','');},calculate:function(){$('.my-selected-periods input').each(function(){if($(this).val().length==0){$(this).val(0);$(this).attr('value',0);}});values.user.trxUtilizationDates=[];for(var i=0;i<calculator.selectedDates.length;i++)values.user.trxUtilizationDates.push(calculator.selectedDates[i]);values.user.values=[];$('li.selected').each(function(){var _selDrug=$(this).attr('rel-drug');var _val=$.extend(true,{},values.defaults.values[_selDrug]);values.user.values.push(_val);});for(var i=0;i<values.user.values.length;i++)for(var j=0;j<values.user.values[i].variants.length;j++)values.user.values[i].variants[j].trxUtilization=[];$('.my-selected-periods tr').each(function(i){$(this).find('td').each(function(j){$(this).find('input').each(function(y){var _drug=Number($(this).parent().attr('rel-user-drug'));var _variant=Number($(this).parent().attr('rel-variant'));var _val=Number($(this).val());if(calculator.selectedPeriod==0)values.user.values[_drug].variants[_variant].trxUtilization.push(_val);else if(calculator.selectedPeriod==1)for(var i=0;i<3;i++)values.user.values[_drug].variants[_variant].trxUtilization.push(_val/3);else{if(calculator.selectedPeriod==2)for(var i=0;i<12;i++)values.user.values[_drug].variants[_variant].trxUtilization.push(_val/12);}});});});calculator.results.show();},results:{show:function(){$('input[type="number"]').each(function(){$(this).attr('value',$(this).val());});userCalcs=$('#calculator').html();calculator.selectedDrug=0;calculate.init(false);calculator.results.buildChartNav();calculator.results.buildCharts();$('#calculator').hide();$('#results').show();$('body').scrollTop(0);calculator.scroll.bind();$('.forcedScroll').hide();try{$('.the-table-container').getNiceScroll().hide();}catch(err){}},buildChartNav:function(){$('.chart-nav').html('');for(i=0;i<values.user.values.length;i++){var _act='';if(i==0)_act=' active';$('.chart-nav').append('<li class="button grey-button'+_act+'" rel-drug="'+i+'">'+calculate.charts.removeOrreplaceSups(values.user.values[i].htmlLabel)+'</li>');}$('.chart-nav li').click(function(){$('.chart-nav li').removeClass('active');$(this).addClass('active');calculator.selectedDrug=$(this).attr('rel-drug');calculator.results.buildCharts(calculator.selectedDrug);});},buildCharts:function(){calculate.init(false);calculate.charts.buildDoseMix(calculator.selectedDrug);calculate.charts.buildWad();calculate.charts.buildWac();}}};;
function getMonthNumber(monthString){var dateHash={Jan:'01',Feb:'02',Mar:'03',Apr:'04',May:'05',Jun:'06',Jul:'07',Aug:'08',Sep:'09',Oct:'10',Nov:'11',Dec:'12'};return dateHash[monthString];}function makeDatesLegacy(){$('.acc-m').html(values.date.month);$('.acc-mn').html(getMonthNumber(values.date.month));$('.acc-d').html(values.date.date<10?'0'+values.date.date:values.date.date);$('.acc-y').html(values.date.year);}function makeUtilizationValuesLegacy(){$('.aristada-4wks').html((values.aristada.fourWeek*100));$('.aristada-6wks').html((values.aristada.sixWeek*100));}function makeSourcesLegacy(){$('.source-links').html('<strong>Sources:</strong>');for(var i=0;i<values.sources.length;i++){var _link='<br/>';_link+='<strong>'+String(i+1)+'</strong>';_link+='. ';_link+=values.sources[i].text;_link+=' Accessed ';_link+=values.sources[i].date.month;_link+=' ';_link+=values.sources[i].date.date;_link+=', ';_link+=values.sources[i].date.year;_link+='.';$('.source-links').append(_link);}}var ui={shortMonths:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],init:function(){ui.loadConstants();ui.elements();ui.hoverTouchUnstick();},loadConstants:function(){$.ajax({url:'pages/content/_isi',cache:false,success:function(result){$('.isi').html(result);}});$.ajax({url:'pages/content/_footer',cache:false,success:function(result){$('.footer').html(result);}});ui.unbindSlider();},unbindSlider:function(){$('body').css('overflow-y','auto');$(document).unbind('mousewheel',overview.slider.scroll.mouseScroll);$(document).unbind('keydown',overview.slider.keyboard.keyDown);$(document).unbind('scroll',benchmark.scroll.mouseScroll);$(document).unbind('scroll',calculator.scroll.mouseScroll);$(document).bind('touchmove',benchmark.scroll.mouseScroll);$(document).bind('touchmove',calculator.scroll.mouseScroll);if(overview.slider.isIos)$('body').swipe('option','allowPageScroll','vertical');},elements:function(){$('.nav-btns li').removeClass('active');$('.nav-btns li[rel-page='+app.currentPage+']').addClass('active');$('*[rel-overlay]').off();$('*[rel-overlay]').on('click',function(){ui.overlay.add($(this).attr('rel-overlay'));});$('*[rel-value]').each(function(){});ui.makeSources();ui.makeDates();ui.makeUtilizationValues();},makeSources:function(){var _sources='';var jqxhrSources=$.get("/benchmark_sources",function(data){if(data.drupal_data.use_dv_module_data==1){var _sources=data.drupal_data.source_markup;$('.source-links').html(_sources);}else makeSourcesLegacy();}).done(function(data){}).fail(function(){makeSourcesLegacy();}).always(function(){});},makeDates:function(){var jqxhrSources=$.get("/benchmark_date",function(data){if(data.drupal_data.use_dv_module_data==1){$('.acc-mn').html(getMonthNumber(data.drupal_data.benchmark_date_month));$('.acc-m').html(data.drupal_data.benchmark_date_month);$('.acc-d').html(data.drupal_data.benchmark_date_date<10?'0'+data.drupal_data.benchmark_date_date:data.drupal_data.benchmark_date_date);$('.acc-y').html(data.drupal_data.benchmark_date_year);}else makeDatesLegacy();}).done(function(data){}).fail(function(){makeDatesLegacy();}).always(function(){});},makeUtilizationValues:function(){var jqxhrSources=$.get("/benchmark_data",function(data){if(data.drupal_data.use_dv_module_data==1){$('.aristada-4wks').html((data.drupal_data.aristada.fourWeek*100));$('.aristada-6wks').html((data.drupal_data.aristada.sixWeek*100));}else makeUtilizationValuesLegacy();}).done(function(data){}).fail(function(){makeUtilizationValuesLegacy();}).always(function(){});},showError:function(_str){$('.error-alert').remove();var _err='<div class="error-alert animated fadeInDown">';_err+=_str;_err+='<span class="error-alert-close">&nbsp;</span>';_err+='</div>';$('body').append(_err);$('.error-alert').click(function(){$(this).remove();});},overlay:{add:function(_content){var _overlay='<div class="overlay"></div>';$('body').append(_overlay);$('.overlay').load(_content,function(){$('.overlay').addClass('animated fadeIn');$('.close-overlay').click(function(){ui.overlay.remove();});$('.close-overlay-small').click(function(){ui.overlay.remove();});});},remove:function(){$('.overlay').remove();$('#dataDump').remove();}},value:{inject:function(_element,_value){if($(_element).prop('tagName')!='input'){}else{}}},hoverTouchUnstick:function(){if('ontouchstart' in document.documentElement)for(var sheetI=document.styleSheets.length-1;sheetI>=0;sheetI--){var sheet=document.styleSheets[sheetI];if(sheet.cssRules)for(var ruleI=sheet.cssRules.length-1;ruleI>=0;ruleI--){var rule=sheet.cssRules[ruleI];if(rule.selectorText)rule.selectorText=rule.selectorText.replace(":hover",":active");}}}};;
(function($,Drupal){Drupal.theme.progressBar=function(id){const escapedId=Drupal.checkPlain(id);return (`<div id="${escapedId}" class="progress" aria-live="polite">`+'<div class="progress__label">&nbsp;</div>'+'<div class="progress__track"><div class="progress__bar"></div></div>'+'<div class="progress__percentage"></div>'+'<div class="progress__description">&nbsp;</div>'+'</div>');};Drupal.ProgressBar=function(id,updateCallback,method,errorCallback){this.id=id;this.method=method||'GET';this.updateCallback=updateCallback;this.errorCallback=errorCallback;this.element=$(Drupal.theme('progressBar',id));};$.extend(Drupal.ProgressBar.prototype,{setProgress(percentage,message,label){if(percentage>=0&&percentage<=100){$(this.element).find('div.progress__bar').each(function(){this.style.width=`${percentage}%`;});$(this.element).find('div.progress__percentage').html(`${percentage}%`);}$('div.progress__description',this.element).html(message);$('div.progress__label',this.element).html(label);if(this.updateCallback)this.updateCallback(percentage,message,this);},startMonitoring(uri,delay){this.delay=delay;this.uri=uri;this.sendPing();},stopMonitoring(){clearTimeout(this.timer);this.uri=null;},sendPing(){if(this.timer)clearTimeout(this.timer);if(this.uri){const pb=this;let uri=this.uri;if(!uri.includes('?'))uri+='?';else uri+='&';uri+='_format=json';$.ajax({type:this.method,url:uri,data:'',dataType:'json',success(progress){if(progress.status===0){pb.displayError(progress.data);return;}pb.setProgress(progress.percentage,progress.message,progress.label);pb.timer=setTimeout(()=>{pb.sendPing();},pb.delay);},error(xmlhttp){const e=new Drupal.AjaxError(xmlhttp,pb.uri);pb.displayError(`<pre>${e.message}</pre>`);}});}},displayError(string){const error=$('<div class="messages messages--error"></div>').html(string);$(this.element).before(error).hide();if(this.errorCallback)this.errorCallback(this);}});})(jQuery,Drupal);;
/* @license MIT https://raw.githubusercontent.com/muicss/loadjs/4.3.0/LICENSE.txt */
loadjs=function(){var h=function(){},o={},c={},f={};function u(e,n){if(e){var t=f[e];if(c[e]=n,t)for(;t.length;)t[0](e,n),t.splice(0,1)}}function l(e,n){e.call&&(e={success:e}),n.length?(e.error||h)(n):(e.success||h)(e)}function p(t,r,i,s){var o,e,u,n=document,c=i.async,f=(i.numRetries||0)+1,l=i.before||h,a=t.replace(/[\?|#].*$/,""),d=t.replace(/^(css|img|module|nomodule)!/,"");if(s=s||0,/(^css!|\.css$)/.test(a))(u=n.createElement("link")).rel="stylesheet",u.href=d,(o="hideFocus"in u)&&u.relList&&(o=0,u.rel="preload",u.as="style");else if(/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(a))(u=n.createElement("img")).src=d;else if((u=n.createElement("script")).src=d,u.async=void 0===c||c,e="noModule"in u,/^module!/.test(a)){if(!e)return r(t,"l");u.type="module"}else if(/^nomodule!/.test(a)&&e)return r(t,"l");!(u.onload=u.onerror=u.onbeforeload=function(e){var n=e.type[0];if(o)try{u.sheet.cssText.length||(n="e")}catch(e){18!=e.code&&(n="e")}if("e"==n){if((s+=1)<f)return p(t,r,i,s)}else if("preload"==u.rel&&"style"==u.as)return u.rel="stylesheet";r(t,n,e.defaultPrevented)})!==l(t,u)&&n.head.appendChild(u)}function t(e,n,t){var r,i;if(n&&n.trim&&(r=n),i=(r?t:n)||{},r){if(r in o)throw"LoadJS";o[r]=!0}function s(n,t){!function(e,r,n){var t,i,s=(e=e.push?e:[e]).length,o=s,u=[];for(t=function(e,n,t){if("e"==n&&u.push(e),"b"==n){if(!t)return;u.push(e)}--s||r(u)},i=0;i<o;i++)p(e[i],t,n)}(e,function(e){l(i,e),n&&l({success:n,error:t},e),u(r,e)},i)}if(i.returnPromise)return new Promise(s);s()}return t.ready=function(e,n){return function(e,t){e=e.push?e:[e];var n,r,i,s=[],o=e.length,u=o;for(n=function(e,n){n.length&&s.push(e),--u||t(s)};o--;)r=e[o],(i=c[r])?n(r,i):(f[r]=f[r]||[]).push(n)}(e,function(e){l(n,e)}),t},t.done=function(e){u(e,[])},t.reset=function(){o={},c={},f={}},t.isDefined=function(e){return e in o},t}();;
/* @license GPL-2.0-or-later https://www.drupal.org/licensing/faq */
(function(Drupal,debounce){let liveElement;const announcements=[];Drupal.behaviors.drupalAnnounce={attach(context){if(!liveElement){liveElement=document.createElement('div');liveElement.id='drupal-live-announce';liveElement.className='visually-hidden';liveElement.setAttribute('aria-live','polite');liveElement.setAttribute('aria-busy','false');document.body.appendChild(liveElement);}}};function announce(){const text=[];let priority='polite';let announcement;const il=announcements.length;for(let i=0;i<il;i++){announcement=announcements.pop();text.unshift(announcement.text);if(announcement.priority==='assertive')priority='assertive';}if(text.length){liveElement.innerHTML='';liveElement.setAttribute('aria-busy','true');liveElement.setAttribute('aria-live',priority);liveElement.innerHTML=text.join('\n');liveElement.setAttribute('aria-busy','false');}}Drupal.announce=function(text,priority){announcements.push({text,priority});return debounce(announce,200)();};})(Drupal,Drupal.debounce);;
((Drupal)=>{Drupal.Message=class{constructor(messageWrapper=null){if(!messageWrapper)this.messageWrapper=Drupal.Message.defaultWrapper();else this.messageWrapper=messageWrapper;}static defaultWrapper(){let wrapper=document.querySelector('[data-drupal-messages]')||document.querySelector('[data-drupal-messages-fallback]');if(!wrapper){wrapper=document.createElement('div');document.body.appendChild(wrapper);}if(wrapper.hasAttribute('data-drupal-messages-fallback')){wrapper.removeAttribute('data-drupal-messages-fallback');wrapper.classList.remove('hidden');}wrapper.setAttribute('data-drupal-messages','');return wrapper.innerHTML===''?Drupal.Message.messageInternalWrapper(wrapper):wrapper.firstElementChild;}static getMessageTypeLabels(){return {status:Drupal.t('Status message'),error:Drupal.t('Error message'),warning:Drupal.t('Warning message')};}add(message,options={}){if(!options.hasOwnProperty('type'))options.type='status';if(typeof message!=='string')throw new Error('Message must be a string.');Drupal.Message.announce(message,options);options.id=options.id?String(options.id):`${options.type}-${Math.random().toFixed(15).replace('0.','')}`;if(!Drupal.Message.getMessageTypeLabels().hasOwnProperty(options.type)){const {type}=options;throw new Error(`The message type, ${type}, is not present in Drupal.Message.getMessageTypeLabels().`);}this.messageWrapper.appendChild(Drupal.theme('message',{text:message},options));return options.id;}select(id){return this.messageWrapper.querySelector(`[data-drupal-message-id^="${id}"]`);}remove(id){return this.messageWrapper.removeChild(this.select(id));}clear(){Array.prototype.forEach.call(this.messageWrapper.querySelectorAll('[data-drupal-message-id]'),(message)=>{this.messageWrapper.removeChild(message);});}static announce(message,options){if(!options.priority&&(options.type==='warning'||options.type==='error'))options.priority='assertive';if(options.announce!=='')Drupal.announce(options.announce||message,options.priority);}static messageInternalWrapper(messageWrapper){const innerWrapper=document.createElement('div');innerWrapper.setAttribute('class','messages__wrapper');messageWrapper.insertAdjacentElement('afterbegin',innerWrapper);return innerWrapper;}};Drupal.theme.message=({text},{type,id})=>{const messagesTypes=Drupal.Message.getMessageTypeLabels();const messageWrapper=document.createElement('div');messageWrapper.setAttribute('class',`messages messages--${type}`);messageWrapper.setAttribute('role',type==='error'||type==='warning'?'alert':'status');messageWrapper.setAttribute('data-drupal-message-id',id);messageWrapper.setAttribute('data-drupal-message-type',type);messageWrapper.setAttribute('aria-label',messagesTypes[type]);messageWrapper.innerHTML=`${text}`;return messageWrapper;};})(Drupal);;
(function($,window,Drupal,drupalSettings,loadjs,{isFocusable,tabbable}){Drupal.behaviors.AJAX={attach(context,settings){function loadAjaxBehavior(base){const elementSettings=settings.ajax[base];if(typeof elementSettings.selector==='undefined')elementSettings.selector=`#${base}`;once('drupal-ajax',$(elementSettings.selector)).forEach((el)=>{elementSettings.element=el;elementSettings.base=base;Drupal.ajax(elementSettings);});}Object.keys(settings.ajax||{}).forEach(loadAjaxBehavior);Drupal.ajax.bindAjaxLinks(document.body);once('ajax','.use-ajax-submit').forEach((el)=>{const elementSettings={};elementSettings.url=$(el.form).attr('action');elementSettings.setClick=true;elementSettings.event='click';elementSettings.progress={type:'throbber'};elementSettings.base=el.id;elementSettings.element=el;Drupal.ajax(elementSettings);});},detach(context,settings,trigger){if(trigger==='unload')Drupal.ajax.expired().forEach((instance)=>{Drupal.ajax.instances[instance.instanceIndex]=null;});}};Drupal.AjaxError=function(xmlhttp,uri,customMessage){let statusCode;let statusText;let responseText;if(xmlhttp.status)statusCode=`\n${Drupal.t('An AJAX HTTP error occurred.')}\n${Drupal.t('HTTP Result Code: !status',{'!status':xmlhttp.status})}`;else statusCode=`\n${Drupal.t('An AJAX HTTP request terminated abnormally.')}`;statusCode+=`\n${Drupal.t('Debugging information follows.')}`;const pathText=`\n${Drupal.t('Path: !uri',{'!uri':uri})}`;statusText='';try{statusText=`\n${Drupal.t('StatusText: !statusText',{'!statusText':xmlhttp.statusText.trim()})}`;}catch(e){}responseText='';try{responseText=`\n${Drupal.t('ResponseText: !responseText',{'!responseText':xmlhttp.responseText.trim()})}`;}catch(e){}responseText=responseText.replace(/<("[^"]*"|'[^']*'|[^'">])*>/gi,'');responseText=responseText.replace(/[\n]+\s+/g,'\n');const readyStateText=xmlhttp.status===0?`\n${Drupal.t('ReadyState: !readyState',{'!readyState':xmlhttp.readyState})}`:'';customMessage=customMessage?`\n${Drupal.t('CustomMessage: !customMessage',{'!customMessage':customMessage})}`:'';this.message=statusCode+pathText+statusText+customMessage+responseText+readyStateText;this.name='AjaxError';if(!Drupal.AjaxError.messages)Drupal.AjaxError.messages=new Drupal.Message();Drupal.AjaxError.messages.add(Drupal.t("Oops, something went wrong. Check your browser's developer console for more details."),{type:'error'});};Drupal.AjaxError.prototype=new Error();Drupal.AjaxError.prototype.constructor=Drupal.AjaxError;Drupal.ajax=function(settings){if(arguments.length!==1)throw new Error('Drupal.ajax() function must be called with one configuration object only');const base=settings.base||false;const element=settings.element||false;delete settings.base;delete settings.element;if(!settings.progress&&!element)settings.progress=false;const ajax=new Drupal.Ajax(base,element,settings);ajax.instanceIndex=Drupal.ajax.instances.length;Drupal.ajax.instances.push(ajax);return ajax;};Drupal.ajax.instances=[];Drupal.ajax.expired=function(){return Drupal.ajax.instances.filter((instance)=>instance&&instance.element!==false&&!document.body.contains(instance.element));};Drupal.ajax.bindAjaxLinks=(element)=>{once('ajax','.use-ajax',element).forEach((ajaxLink)=>{const $linkElement=$(ajaxLink);const elementSettings={progress:{type:'throbber'},dialogType:$linkElement.data('dialog-type'),dialog:$linkElement.data('dialog-options'),dialogRenderer:$linkElement.data('dialog-renderer'),base:$linkElement.attr('id'),element:ajaxLink};const href=$linkElement.attr('href');if(href){elementSettings.url=href;elementSettings.event='click';}const httpMethod=$linkElement.data('ajax-http-method');if(httpMethod)elementSettings.httpMethod=httpMethod;Drupal.ajax(elementSettings);});};Drupal.Ajax=function(base,element,elementSettings){const defaults={httpMethod:'POST',event:element?'mousedown':null,keypress:true,selector:base?`#${base}`:null,effect:'none',speed:'none',method:'replaceWith',progress:{type:'throbber',message:Drupal.t('Processing...')},submit:{js:true}};$.extend(this,defaults,elementSettings);this.commands=new Drupal.AjaxCommands();this.instanceIndex=false;if(this.wrapper)this.wrapper=`#${this.wrapper}`;this.element=element;this.preCommandsFocusedElementSelector=null;this.elementSettings=elementSettings;if(this.element&&this.element.form)this.$form=$(this.element.form);if(!this.url){const $element=$(this.element);if(this.element.tagName==='A')this.url=$element.attr('href');else{if(this.element&&element.form)this.url=this.$form.attr('action');}}const originalUrl=this.url;this.url=this.url.replace(/\/nojs(\/|$|\?|#)/,'/ajax$1');if(drupalSettings.ajaxTrustedUrl[originalUrl])drupalSettings.ajaxTrustedUrl[this.url]=true;const ajax=this;ajax.options={url:ajax.url,data:ajax.submit,isInProgress(){return ajax.ajaxing;},beforeSerialize(elementSettings,options){return ajax.beforeSerialize(elementSettings,options);},beforeSubmit(formValues,elementSettings,options){ajax.ajaxing=true;ajax.preCommandsFocusedElementSelector=null;return ajax.beforeSubmit(formValues,elementSettings,options);},beforeSend(xmlhttprequest,options){ajax.ajaxing=true;return ajax.beforeSend(xmlhttprequest,options);},success(response,status,xmlhttprequest){ajax.preCommandsFocusedElementSelector=document.activeElement.getAttribute('data-drupal-selector');if(typeof response==='string')response=$.parseJSON(response);if(response!==null&&!drupalSettings.ajaxTrustedUrl[ajax.url])if(xmlhttprequest.getResponseHeader('X-Drupal-Ajax-Token')!=='1'){const customMessage=Drupal.t('The response failed verification so will not be processed.');return ajax.error(xmlhttprequest,ajax.url,customMessage);}return (Promise.resolve(ajax.success(response,status)).then(()=>{ajax.ajaxing=false;$(document).trigger('ajaxSuccess',[xmlhttprequest,this]);$(document).trigger('ajaxComplete',[xmlhttprequest,this]);if(--$.active===0)$(document).trigger('ajaxStop');}));},error(xmlhttprequest,status,error){ajax.ajaxing=false;},complete(xmlhttprequest,status){if(status==='error'||status==='parsererror')return ajax.error(xmlhttprequest,ajax.url);},dataType:'json',jsonp:false,method:ajax.httpMethod};if(elementSettings.dialog)ajax.options.data.dialogOptions=elementSettings.dialog;if(!ajax.options.url.includes('?'))ajax.options.url+='?';else ajax.options.url+='&';let wrapper=`drupal_${elementSettings.dialogType||'ajax'}`;if(elementSettings.dialogRenderer)wrapper+=`.${elementSettings.dialogRenderer}`;ajax.options.url+=`${Drupal.ajax.WRAPPER_FORMAT}=${wrapper}`;$(ajax.element).on(elementSettings.event,function(event){if(!drupalSettings.ajaxTrustedUrl[ajax.url]&&!Drupal.url.isLocal(ajax.url))throw new Error(Drupal.t('The callback URL is not local and not trusted: !url',{'!url':ajax.url}));return ajax.eventResponse(this,event);});if(elementSettings.keypress)$(ajax.element).on('keypress',function(event){return ajax.keypressResponse(this,event);});if(elementSettings.prevent)$(ajax.element).on(elementSettings.prevent,false);};Drupal.ajax.WRAPPER_FORMAT='_wrapper_format';Drupal.Ajax.AJAX_REQUEST_PARAMETER='_drupal_ajax';Drupal.Ajax.prototype.execute=function(){if(this.ajaxing)return;try{this.beforeSerialize(this.element,this.options);return $.ajax(this.options);}catch(e){this.ajaxing=false;window.alert(`An error occurred while attempting to process ${this.options.url}: ${e.message}`);return $.Deferred().reject();}};Drupal.Ajax.prototype.keypressResponse=function(element,event){const ajax=this;if(event.which===13||(event.which===32&&element.type!=='text'&&element.type!=='textarea'&&element.type!=='tel'&&element.type!=='number')){event.preventDefault();event.stopPropagation();$(element).trigger(ajax.elementSettings.event);}};Drupal.Ajax.prototype.eventResponse=function(element,event){event.preventDefault();event.stopPropagation();const ajax=this;if(ajax.ajaxing)return;try{if(ajax.$form){if(ajax.setClick)element.form.clk=element;ajax.$form.ajaxSubmit(ajax.options);}else{ajax.beforeSerialize(ajax.element,ajax.options);$.ajax(ajax.options);}}catch(e){ajax.ajaxing=false;window.alert(`An error occurred while attempting to process ${ajax.options.url}: ${e.message}`);}};Drupal.Ajax.prototype.beforeSerialize=function(element,options){if(this.$form&&document.body.contains(this.$form.get(0))){const settings=this.settings||drupalSettings;Drupal.detachBehaviors(this.$form.get(0),settings,'serialize');}options.data[Drupal.Ajax.AJAX_REQUEST_PARAMETER]=1;const pageState=drupalSettings.ajaxPageState;options.data['ajax_page_state[theme]']=pageState.theme;options.data['ajax_page_state[theme_token]']=pageState.theme_token;options.data['ajax_page_state[libraries]']=pageState.libraries;};Drupal.Ajax.prototype.beforeSubmit=function(formValues,element,options){};Drupal.Ajax.prototype.beforeSend=function(xmlhttprequest,options){if(this.$form){options.extraData=options.extraData||{};options.extraData.ajax_iframe_upload='1';const v=$.fieldValue(this.element);if(v!==null)options.extraData[this.element.name]=v;}$(this.element).prop('disabled',true);if(!this.progress||!this.progress.type)return;const progressIndicatorMethod=`setProgressIndicator${this.progress.type.slice(0,1).toUpperCase()}${this.progress.type.slice(1).toLowerCase()}`;if(progressIndicatorMethod in this&&typeof this[progressIndicatorMethod]==='function')this[progressIndicatorMethod].call(this);};Drupal.theme.ajaxProgressThrobber=(message)=>{const messageMarkup=typeof message==='string'?Drupal.theme('ajaxProgressMessage',message):'';const throbber='<div class="throbber">&nbsp;</div>';return `<div class="ajax-progress ajax-progress-throbber">${throbber}${messageMarkup}</div>`;};Drupal.theme.ajaxProgressIndicatorFullscreen=()=>'<div class="ajax-progress ajax-progress-fullscreen">&nbsp;</div>';Drupal.theme.ajaxProgressMessage=(message)=>`<div class="message">${message}</div>`;Drupal.theme.ajaxProgressBar=($element)=>$('<div class="ajax-progress ajax-progress-bar"></div>').append($element);Drupal.Ajax.prototype.setProgressIndicatorBar=function(){const progressBar=new Drupal.ProgressBar(`ajax-progress-${this.element.id}`,$.noop,this.progress.method,$.noop);if(this.progress.message)progressBar.setProgress(-1,this.progress.message);if(this.progress.url)progressBar.startMonitoring(this.progress.url,this.progress.interval||1500);this.progress.element=$(Drupal.theme('ajaxProgressBar',progressBar.element));this.progress.object=progressBar;$(this.element).after(this.progress.element);};Drupal.Ajax.prototype.setProgressIndicatorThrobber=function(){this.progress.element=$(Drupal.theme('ajaxProgressThrobber',this.progress.message));if($(this.element).closest('[data-drupal-ajax-container]').length)$(this.element).closest('[data-drupal-ajax-container]').after(this.progress.element);else $(this.element).after(this.progress.element);};Drupal.Ajax.prototype.setProgressIndicatorFullscreen=function(){this.progress.element=$(Drupal.theme('ajaxProgressIndicatorFullscreen'));$('body').append(this.progress.element);};Drupal.Ajax.prototype.commandExecutionQueue=function(response,status){const ajaxCommands=this.commands;return Object.keys(response||{}).reduce((executionQueue,key)=>executionQueue.then(()=>{const {command}=response[key];if(command&&ajaxCommands[command])return ajaxCommands[command](this,response[key],status);}),Promise.resolve());};Drupal.Ajax.prototype.success=function(response,status){if(this.progress.element)$(this.progress.element).remove();if(this.progress.object)this.progress.object.stopMonitoring();$(this.element).prop('disabled',false);const elementParents=$(this.element).parents('[data-drupal-selector]').addBack().toArray();const focusChanged=Object.keys(response||{}).some((key)=>{const {command,method}=response[key];return (command==='focusFirst'||command==='openDialog'||(command==='invoke'&&method==='focus'));});return (this.commandExecutionQueue(response,status).then(()=>{if(!focusChanged){let target=false;if(this.element){if($(this.element).data('refocus-blur')&&this.preCommandsFocusedElementSelector)target=document.querySelector(`[data-drupal-selector="${this.preCommandsFocusedElementSelector}"]`);if(!target&&!$(this.element).data('disable-refocus')){for(let n=elementParents.length-1;!target&&n>=0;n--)target=document.querySelector(`[data-drupal-selector="${elementParents[n].getAttribute('data-drupal-selector')}"]`);}}if(target)$(target).trigger('focus');}if(this.$form&&document.body.contains(this.$form.get(0))){const settings=this.settings||drupalSettings;Drupal.attachBehaviors(this.$form.get(0),settings);}this.settings=null;}).catch((error)=>console.error(Drupal.t('An error occurred during the execution of the Ajax response: !error',{'!error':error}))));};Drupal.Ajax.prototype.getEffect=function(response){const type=response.effect||this.effect;const speed=response.speed||this.speed;const effect={};if(type==='none'){effect.showEffect='show';effect.hideEffect='hide';effect.showSpeed='';}else if(type==='fade'){effect.showEffect='fadeIn';effect.hideEffect='fadeOut';effect.showSpeed=speed;}else{effect.showEffect=`${type}Toggle`;effect.hideEffect=`${type}Toggle`;effect.showSpeed=speed;}return effect;};Drupal.Ajax.prototype.error=function(xmlhttprequest,uri,customMessage){if(this.progress.element)$(this.progress.element).remove();if(this.progress.object)this.progress.object.stopMonitoring();$(this.wrapper).show();$(this.element).prop('disabled',false);if(this.$form&&document.body.contains(this.$form.get(0))){const settings=this.settings||drupalSettings;Drupal.attachBehaviors(this.$form.get(0),settings);}throw new Drupal.AjaxError(xmlhttprequest,uri,customMessage);};Drupal.theme.ajaxWrapperNewContent=($newContent,ajax,response)=>(response.effect||ajax.effect)!=='none'&&$newContent.filter((i)=>!(($newContent[i].nodeName==='#comment'||($newContent[i].nodeName==='#text'&&/^(\s|\n|\r)*$/.test($newContent[i].textContent))))).length>1?Drupal.theme('ajaxWrapperMultipleRootElements',$newContent):$newContent;Drupal.theme.ajaxWrapperMultipleRootElements=($elements)=>$('<div></div>').append($elements);Drupal.AjaxCommands=function(){};Drupal.AjaxCommands.prototype={insert(ajax,response){const $wrapper=response.selector?$(response.selector):$(ajax.wrapper);const method=response.method||ajax.method;const effect=ajax.getEffect(response);const settings=response.settings||ajax.settings||drupalSettings;const parseHTML=(htmlString)=>{const fragment=document.createDocumentFragment();const tempDiv=fragment.appendChild(document.createElement('div'));tempDiv.innerHTML=htmlString;return tempDiv.childNodes;};let $newContent=$(parseHTML(response.data));$newContent=Drupal.theme('ajaxWrapperNewContent',$newContent,ajax,response);switch(method){case 'html':case 'replaceWith':case 'replaceAll':case 'empty':case 'remove':Drupal.detachBehaviors($wrapper.get(0),settings);break;default:break;}$wrapper[method]($newContent);if(effect.showEffect!=='show')$newContent.hide();const $ajaxNewContent=$newContent.find('.ajax-new-content');if($ajaxNewContent.length){$ajaxNewContent.hide();$newContent.show();$ajaxNewContent[effect.showEffect](effect.showSpeed);}else{if(effect.showEffect!=='show')$newContent[effect.showEffect](effect.showSpeed);}$newContent.each((index,element)=>{if(element.nodeType===Node.ELEMENT_NODE&&document.documentElement.contains(element))Drupal.attachBehaviors(element,settings);});},remove(ajax,response,status){const settings=response.settings||ajax.settings||drupalSettings;$(response.selector).each(function(){Drupal.detachBehaviors(this,settings);}).remove();},changed(ajax,response,status){const $element=$(response.selector);if(!$element.hasClass('ajax-changed')){$element.addClass('ajax-changed');if(response.asterisk)$element.find(response.asterisk).append(` <abbr class="ajax-changed" title="${Drupal.t('Changed')}">*</abbr> `);}},alert(ajax,response,status){window.alert(response.text);},announce(ajax,response){if(response.priority)Drupal.announce(response.text,response.priority);else Drupal.announce(response.text);},redirect(ajax,response,status){window.location=response.url;},css(ajax,response,status){$(response.selector).css(response.argument);},settings(ajax,response,status){const ajaxSettings=drupalSettings.ajax;if(ajaxSettings)Drupal.ajax.expired().forEach((instance)=>{if(instance.selector){const selector=instance.selector.replace('#','');if(selector in ajaxSettings)delete ajaxSettings[selector];}});if(response.merge)$.extend(true,drupalSettings,response.settings);else ajax.settings=response.settings;},data(ajax,response,status){$(response.selector).data(response.name,response.value);},focusFirst(ajax,response,status){let focusChanged=false;const container=document.querySelector(response.selector);if(container){const tabbableElements=tabbable(container);if(tabbableElements.length){tabbableElements[0].focus();focusChanged=true;}else{if(isFocusable(container)){container.focus();focusChanged=true;}}}if(ajax.hasOwnProperty('element')&&!focusChanged)ajax.element.focus();},invoke(ajax,response,status){const $element=$(response.selector);$element[response.method](...response.args);},restripe(ajax,response,status){$(response.selector).find('> tbody > tr:visible, > tr:visible').removeClass('odd even').filter(':even').addClass('odd').end().filter(':odd').addClass('even');},update_build_id(ajax,response,status){document.querySelectorAll(`input[name="form_build_id"][value="${response.old}"]`).forEach((item)=>{item.value=response.new;});},add_css(ajax,response,status){if(typeof response.data==='string'){Drupal.deprecationError({message:'Passing a string to the Drupal.ajax.add_css() method is deprecated in 10.1.0 and is removed from drupal:11.0.0. See https://www.drupal.org/node/3154948.'});$('head').prepend(response.data);return;}const allUniqueBundleIds=response.data.map(function(style){const uniqueBundleId=style.href;if(!loadjs.isDefined(uniqueBundleId))loadjs(`css!${style.href}`,uniqueBundleId,{before(path,styleEl){Object.keys(style).forEach((attributeKey)=>{styleEl.setAttribute(attributeKey,style[attributeKey]);});}});return uniqueBundleId;});return new Promise((resolve,reject)=>{loadjs.ready(allUniqueBundleIds,{success(){resolve();},error(depsNotFound){const message=Drupal.t(`The following files could not be loaded: @dependencies`,{'@dependencies':depsNotFound.join(', ')});reject(message);}});});},message(ajax,response){const messages=new Drupal.Message(document.querySelector(response.messageWrapperQuerySelector));if(response.clearPrevious)messages.clear();messages.add(response.message,response.messageOptions);},add_js(ajax,response,status){const parentEl=document.querySelector(response.selector||'body');const settings=ajax.settings||drupalSettings;const allUniqueBundleIds=response.data.map((script)=>{const uniqueBundleId=script.src;if(!loadjs.isDefined(uniqueBundleId))loadjs(script.src,uniqueBundleId,{async:false,before(path,scriptEl){Object.keys(script).forEach((attributeKey)=>{scriptEl.setAttribute(attributeKey,script[attributeKey]);});parentEl.appendChild(scriptEl);return false;}});return uniqueBundleId;});return new Promise((resolve,reject)=>{loadjs.ready(allUniqueBundleIds,{success(){Drupal.attachBehaviors(parentEl,settings);resolve();},error(depsNotFound){const message=Drupal.t(`The following files could not be loaded: @dependencies`,{'@dependencies':depsNotFound.join(', ')});reject(message);}});});},scrollTop(ajax,response){const offset=$(response.selector).offset();let scrollTarget=response.selector;while($(scrollTarget).scrollTop()===0&&$(scrollTarget).parent())scrollTarget=$(scrollTarget).parent();if(offset.top-10<$(scrollTarget).scrollTop())scrollTarget.get(0).scrollTo({top:offset.top-10,behavior:'smooth'});}};const stopEvent=(xhr,settings)=>{return (xhr.getResponseHeader('X-Drupal-Ajax-Token')==='1'&&settings.isInProgress&&settings.isInProgress());};$.extend(true,$.event.special,{ajaxSuccess:{trigger(event,xhr,settings){if(stopEvent(xhr,settings))return false;}},ajaxComplete:{trigger(event,xhr,settings){if(stopEvent(xhr,settings)){$.active++;return false;}}}});})(jQuery,window,Drupal,drupalSettings,loadjs,window.tabbable);;
(function(Drupal){Drupal.AjaxCommands.prototype.gtagEvent=function(ajax,response){gtag('event',response.event_name,response.data);};})(Drupal);;
